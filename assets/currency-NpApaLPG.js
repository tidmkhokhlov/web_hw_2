import"./style-Cvjpl_yh.js";const f="https://api.adviceslip.com",c=document.getElementById("advicesForm"),r=document.getElementById("advicesCount"),a=document.getElementById("getAdvices"),s=document.getElementById("advicesResult");if(!c||!r||!a||!s)console.error("Advice widgets are missing in the markup.");else{const d=()=>{const e=Number(r.value);return Number.isNaN(e)||e<=0?1:Math.min(Math.floor(e),10)},l=async()=>{const e=await fetch(`${f}/advice?timestamp=${Date.now()}`,{cache:"no-store"});if(!e.ok)throw new Error("Request failed");const t=await e.json(),n=t&&t.slip&&t.slip.advice;if(!n)throw new Error("Advice is missing in response");return n},m=async e=>{const t=[],n=new Set;for(;t.length<e;){const o=(await l()).trim();n.has(o)||(t.push(o),n.add(o))}return t},i=e=>{a.disabled=e,c.classList.toggle("loading",e),e&&(s.textContent="Загрузка...")},u=e=>{if(e.length===0){s.textContent="Советы не найдены.";return}const t=e.map(n=>`<li>${n}</li>`).join("");s.innerHTML=`
      <h3>Подборка советов</h3>
      <ol>${t}</ol>
    `},h=e=>{s.textContent=e},v=async e=>{e.preventDefault(),i(!0);try{const t=d(),n=await m(t);u(n)}catch(t){console.error(t),h("Ошибка при получении данных. Попробуйте позже.")}finally{i(!1)}};c.addEventListener("submit",v)}
